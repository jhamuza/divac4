<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DiVA Cohort 4 Selection Justification</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* Basic Styles - For demonstration, assume style.css exists */
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f7f6;
            display: flex;
            justify-content: center;
            align-items: flex-start; /* Align to top to give space for navigation at bottom */
            min-height: 100vh;
            color: #333;
        }

        .presentation-container {
            background-color: #ffffff;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            width: 90%;
            max-width: 1000px;
            margin: 20px auto;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            min-height: 80vh; /* Ensure it takes up enough height */
        }

        .presentation-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 30px;
            background-color: #e0f2f7; /* Light blue */
            border-bottom: 1px solid #cce7ee;
            border-top-left-radius: 12px;
            border-top-right-radius: 12px;
        }

        .presentation-nav h4 {
            margin: 0;
            color: #2a6f8b;
            font-weight: 600;
        }

        .slide-counter {
            font-size: 1.1em;
            font-weight: 500;
            color: #555;
        }

        .btn {
            padding: 8px 18px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn--primary {
            background-color: #2a6f8b;
            color: #ffffff;
            box-shadow: 0 4px 10px rgba(42, 111, 139, 0.3);
        }

        .btn--primary:hover {
            background-color: #1a5b74;
            box-shadow: 0 6px 15px rgba(42, 111, 139, 0.4);
        }

        .btn--secondary {
            background-color: #f0f8ff;
            color: #2a6f8b;
            border: 1px solid #2a6f8b;
        }

        .btn--secondary:hover {
            background-color: #e0eff5;
        }

        .slides-container {
            flex-grow: 1;
            position: relative;
            padding: 20px 0; /* Add padding for internal slides */
            overflow: hidden;
        }

        .slide {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.6s ease-in-out, visibility 0.6s ease-in-out;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 0 40px; /* Padding for content within slides */
            box-sizing: border-box;
        }

        .slide.active {
            opacity: 1;
            visibility: visible;
            position: relative; /* Make active slide take up space */
        }

        .slide-content {
            width: 100%;
            max-width: 800px;
            text-align: center;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        /* Title Slide */
        .title-slide h1 {
            font-size: 3.5em;
            color: #2a6f8b;
            margin-bottom: 10px;
            line-height: 1.1;
        }

        .title-slide h2 {
            font-size: 2.2em;
            color: #4a4a4a;
            margin-bottom: 20px;
        }

        .title-details p {
            font-size: 1.2em;
            color: #666;
            margin: 5px 0;
        }

        /* Summary Grid */
        .summary-grid, .framework-grid, .evidence-grid, .companies-grid, .impact-metrics-grid, .overqualified-grid, .methodology-points {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .summary-card, .framework-item, .evidence-card, .impact-card, .overqualified-company, .methodology-item {
            background-color: #f9f9f9;
            border: 1px solid #e0e0e0;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .summary-card:hover, .framework-item:hover, .evidence-card:hover, .impact-card:hover, .overqualified-company:hover, .methodology-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
        }

        .summary-card h3, .impact-card h3 {
            font-size: 2.5em;
            color: #2a6f8b;
            margin-bottom: 10px;
        }

        .summary-card p, .impact-card p {
            font-size: 1.1em;
            color: #555;
        }

        /* Two Column Layout */
        .two-column {
            display: flex;
            gap: 40px;
            text-align: left;
            margin-top: 30px;
        }

        .two-column .column {
            flex: 1;
        }

        .concern-box {
            background-color: #fff3e0;
            border: 1px solid #ffcc80;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .concern-box h4 {
            color: #e65100;
            margin-top: 0;
        }

        .strategic-points li {
            margin-bottom: 10px;
            font-size: 1.1em;
            color: #4a4a4a;
        }

        /* Framework Items */
        .framework-item {
            background-color: #e0f2f7;
            border-color: #b3e5fc;
        }
        .framework-item h3 {
            color: #2a6f8b;
            font-size: 1.3em;
            margin-bottom: 10px;
        }
        .framework-item p {
            color: #555;
            font-size: 0.95em;
        }
        .framework-icon {
            font-size: 2em;
            margin-bottom: 10px;
        }
        .framework-number {
            font-size: 2em;
            color: #2a6f8b;
            font-weight: bold;
            margin-bottom: 10px;
        }


        /* Analysis Sections */
        .analysis-section {
            display: flex;
            flex-direction: column;
            gap: 30px;
            margin-top: 30px;
        }

        .chart-container {
            width: 100%;
            max-width: 600px;
            margin: 0 auto;
        }

        .analysis-stats, .distribution-stats {
            display: flex;
            justify-content: space-around;
            gap: 15px;
            flex-wrap: wrap;
        }

        .stat-item {
            background-color: #f0f0f0;
            padding: 15px 25px;
            border-radius: 8px;
            text-align: center;
            min-width: 150px;
        }

        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #2a6f8b;
            display: block;
        }

        .stat-label {
            font-size: 0.9em;
            color: #666;
        }

        /* Overqualification */
        .overqualification-content {
            text-align: left;
            margin-top: 30px;
        }

        .overqualification-content h3 {
            color: #d32f2f;
            margin-bottom: 20px;
        }

        .example-card {
            background-color: #ffebee;
            border: 1px solid #ef9a9a;
            border-radius: 10px;
            padding: 15px;
            text-align: left;
        }

        .example-card h4 {
            color: #c62828;
            margin-top: 0;
            margin-bottom: 10px;
        }

        .example-card ul {
            list-style: none;
            padding-left: 0;
        }

        .example-card li {
            margin-bottom: 5px;
            color: #555;
        }

        .example-card strong {
            color: #c62828;
        }

        /* Startup Slide */
        .startup-slide {
            text-align: left;
        }

        .startup-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #eee;
        }

        .startup-header h1 {
            font-size: 2.2em;
            color: #2a6f8b;
            margin: 0;
        }

        .startup-meta {
            display: flex;
            gap: 15px;
            font-size: 1.1em;
        }

        .score {
            background-color: #2a6f8b;
            color: #fff;
            padding: 5px 12px;
            border-radius: 20px;
            font-weight: bold;
        }

        .status {
            padding: 5px 12px;
            border-radius: 20px;
            font-weight: 500;
        }

        .sarawakian {
            background-color: #dcedc8;
            color: #558b2f;
        }

        .non-sarawakian {
            background-color: #c8e6c9;
            color: #2e7d32;
        }

        .startup-details {
            display: flex; /* Changed to flex */
            flex-direction: column; /* Stack description and alignment vertically */
            gap: 20px;
        }

        .description-box {
            background-color: #f0f4f7;
            border: 1px solid #e0e7ed;
            border-radius: 10px;
            padding: 20px;
        }

        .description-box h3 {
            color: #2a6f8b;
            margin-top: 0;
            margin-bottom: 10px;
            font-size: 1.3em;
        }

        .description-box p {
            font-size: 1em;
            line-height: 1.6;
            color: #4a4a4a;
        }

        .alignment-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 0; /* Ensure no extra margin if flex-direction column is applied to parent */
        }

        .alignment-item {
            background-color: #e0f2f7;
            border: 1px solid #b3e5fc;
            border-radius: 10px;
            padding: 15px;
        }

        .alignment-item h4 {
            color: #2a6f8b;
            margin-top: 0;
            margin-bottom: 8px;
            font-size: 1.1em;
        }

        .alignment-item p {
            font-size: 0.95em;
            color: #555;
            line-height: 1.5;
        }

        .special-note {
            background-color: #ffecb3;
            border: 1px solid #ffe082;
            border-radius: 8px;
            padding: 10px 15px;
            font-size: 0.9em;
            color: #ff8f00;
            margin-top: 15px;
        }
        .special-note strong {
            color: #ff6f00;
        }

        /* Geographic Analysis */
        .geo-analysis {
            display: flex;
            flex-direction: column;
            gap: 30px;
            margin-top: 30px;
        }

        .geo-insights {
            text-align: center;
        }

        .impact-metrics {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .metric {
            background-color: #e8f5e9;
            padding: 15px 25px;
            border-radius: 10px;
            text-align: center;
            min-width: 180px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        .metric-value {
            font-size: 2.5em;
            font-weight: bold;
            color: #388e3c;
            display: block;
            margin-bottom: 5px;
        }

        .metric-label {
            font-size: 0.9em;
            color: #555;
        }

        .geo-rationale {
            font-style: italic;
            color: #666;
            margin-top: 20px;
        }

        /* Conclusion */
        .conclusion-section {
            text-align: left;
            margin-top: 30px;
        }

        .key-conclusions {
            margin-bottom: 40px;
        }

        .conclusion-point {
            display: flex;
            gap: 15px;
            margin-bottom: 20px; /* Added margin-bottom */
            align-items: flex-start;
        }

        .point-number {
            background-color: #2a6f8b;
            color: white;
            border-radius: 50%;
            width: 35px;
            height: 35px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            flex-shrink: 0;
            font-size: 1.1em;
        }

        .point-content h4 {
            color: #2a6f8b;
            margin: 0 0 5px 0;
        }

        .point-content p {
            color: #4a4a4a;
            line-height: 1.5;
        }

        .recommendations-list {
            list-style: disc;
            padding-left: 20px;
            margin-top: 15px;
        }
        .recommendations-list li {
            margin-bottom: 8px;
            color: #4a4a4a;
        }

        .final-statement {
            background-color: #e3f2fd;
            border: 2px solid #90caf9;
            border-radius: 10px;
            padding: 20px;
            margin-top: 30px;
            font-size: 1.3em;
            font-weight: 500;
            color: #1976d2;
            text-align: center;
        }
        .final-statement strong {
            color: #0d47a1;
        }

        /* Slide Navigator Dots */
        .slide-navigator {
            display: flex;
            justify-content: center;
            padding: 20px 0;
        }

        .slide-dots {
            display: flex;
            gap: 10px;
        }

        .dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background-color: #ccc;
            border: 2px solid #ccc;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .dot.active {
            background-color: #2a6f8b;
            border-color: #2a6f8b;
            transform: scale(1.2);
        }

        /* Company grid in slide 8 */
        .companies-grid {
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            text-align: left;
        }
        .company-card {
            background-color: #f9f9f9;
            border: 1px solid #e0e0e0;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.05);
        }
        .company-card h4 {
            color: #2a6f8b;
            margin-top: 0;
            margin-bottom: 5px;
            font-size: 1.4em;
        }
        .company-card .company-focus {
            font-style: italic;
            color: #666;
            margin-bottom: 10px;
        }
        .company-card .status-tag {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 5px;
            font-size: 0.85em;
            font-weight: 600;
            margin-top: 10px;
        }

        /* High-Scoring Companies Not Selected */
        .concerns-section {
            margin-top: 30px;
            text-align: left;
        }
        .concerns-section h3 {
            color: #d32f2f;
            margin-bottom: 20px;
        }
        .companies-comparison {
            display: flex;
            gap: 30px;
            flex-wrap: wrap;
            justify-content: center; /* Center items when they wrap */
        }
        .not-selected-list, .rationale-box {
            flex: 1;
            min-width: 300px; /* Ensure they don't get too small */
            max-width: 48%; /* Allow them to take up almost half width when side-by-side */
            box-sizing: border-box; /* Include padding and border in width calculation */
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.05);
        }

        .not-selected-list {
            background-color: #ffebee;
            border: 1px solid #ef9a9a;
        }
        .not-selected-list h4 {
            color: #c62828;
            margin-top: 0;
            margin-bottom: 15px;
        }
        .company-item {
            margin-bottom: 10px;
            line-height: 1.4; /* Improve readability */
        }
        .company-item .company-name {
            font-weight: bold;
            color: #333;
        }
        .company-item .company-reason {
            font-size: 0.9em;
            color: #666;
            margin-left: 10px;
        }
        .rationale-box {
            background-color: #e3f2fd;
            border: 1px solid #90caf9;
        }
        .rationale-box h4 {
            color: #1976d2;
            margin-top: 0;
            margin-bottom: 15px;
        }
        .rationale-box p {
            color: #4a4a4a;
            line-height: 1.6;
        }
        .rationale-box strong {
            color: #0d47a1;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .presentation-container {
                width: 95%;
                margin: 10px auto;
            }
            .presentation-nav {
                flex-direction: column;
                gap: 10px;
                padding: 10px 20px;
            }
            .nav-right {
                width: 100%;
                display: flex;
                justify-content: space-around;
            }
            .slide-content {
                padding: 0 20px;
            }
            .title-slide h1 {
                font-size: 2.5em;
            }
            .title-slide h2 {
                font-size: 1.5em;
            }
            .summary-grid, .framework-grid, .evidence-grid, .companies-grid, .impact-metrics-grid, .overqualified-grid, .methodology-points {
                grid-template-columns: 1fr;
            }
            .two-column {
                flex-direction: column;
            }
            .analysis-section, .portfolio-section, .research-section, .geo-analysis, .companies-comparison {
                flex-direction: column;
            }
            .chart-container {
                max-width: 100%;
            }
            .startup-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            .startup-meta {
                width: 100%;
                justify-content: space-between;
            }
            .alignment-section {
                grid-template-columns: 1fr;
            }
            .impact-metrics {
                flex-direction: column;
            }
            /* Specific fix for SpaceIn and other startup alignment sections */
            .startup-details .alignment-section {
                grid-template-columns: 1fr; /* Force single column on small screens */
                gap: 10px; /* Reduce gap for tighter packing */
            }
            .not-selected-list, .rationale-box {
                max-width: 100%; /* Allow full width on small screens */
                min-width: unset; /* Remove min-width constraint */
            }
            .conclusion-point {
                flex-direction: column; /* Stack number and content vertically */
                align-items: center; /* Center content when stacked */
                text-align: center;
            }
            .point-content {
                margin-top: 10px; /* Add space between number and text */
            }
        }

        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background-color: #fff;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            transform: translateY(20px);
            transition: transform 0.3s ease;
        }
        .modal-overlay.active .modal-content {
            transform: translateY(0);
        }

        .modal-close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            font-size: 1.5em;
            cursor: pointer;
            color: #888;
        }
        .modal-close-btn:hover {
            color: #333;
        }

        .modal-content h3 {
            color: #2a6f8b;
            margin-top: 0;
            margin-bottom: 20px;
            font-size: 1.8em;
        }
        .modal-content p {
            line-height: 1.7;
            color: #444;
            text-align: left;
        }

        .loading-spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #2a6f8b;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
            display: none; /* Hidden by default */
        }
        .loading-spinner.active {
            display: block;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* AI Buttons */
        .ai-button-container {
            margin-top: 20px;
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap; /* Allow buttons to wrap on smaller screens */
        }
        .btn--ai {
            background-color: #8e24aa; /* Purple */
            color: white;
            box-shadow: 0 4px 10px rgba(142, 36, 170, 0.3);
            white-space: nowrap; /* Prevent button text from breaking */
        }
        .btn--ai:hover {
            background-color: #6a1b9a;
            box-shadow: 0 6px 15px rgba(142, 36, 170, 0.4);
        }
        .ai-response-box {
            background-color: #e0f7fa;
            border: 1px solid #b2ebf2;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            text-align: left;
            max-height: 250px; /* Increased max-height for more content */
            overflow-y: auto;
            display: none;
            animation: fadeIn 0.5s ease-out;
        }
        .ai-response-box.active {
            display: block;
        }
        .ai-response-box h4 {
            color: #00838f;
            margin-top: 0;
            margin-bottom: 10px;
            font-size: 1.2em;
        }
        .ai-response-box p, .ai-response-box ul, .ai-response-box li {
            color: #333;
            font-size: 0.95em;
            line-height: 1.6;
        }
        .ai-response-box ul {
            list-style: disc;
            padding-left: 20px;
        }
        .ai-response-box strong {
            color: #005662; /* Darker teal for emphasis */
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

    </style>
</head>
<body>
    <div class="presentation-container">
        <!-- Navigation Bar -->
        <nav class="presentation-nav">
            <div class="nav-left">
                <span class="slide-counter">
                    <span id="current-slide">1</span> / <span id="total-slides">15</span>
                </span>
            </div>
            <div class="nav-center">
                <h4>DiVA Cohort 4 Selection Justification</h4>
            </div>
            <div class="nav-right">
                <button class="btn btn--secondary btn--sm" id="prev-btn">Previous</button>
                <button class="btn btn--primary btn--sm" id="next-btn">Next</button>
            </div>
        </nav>

        <!-- Slide Container -->
        <div class="slides-container">
            <!-- Slide 1: Title -->
            <div class="slide active" data-slide="1">
                <div class="slide-content title-slide">
                    <h1>DiVA Cohort 4 Startup Selection</h1>
                    <h2>Strategic Justification Report</h2>
                    <div class="title-details">
                        <p class="subtitle">Presented to Professor Jugdutt</p>
                        <p class="subtitle">Digital Innovation & Venture Accelerator Program</p>
                        <p class="date">June 2025</p>
                    </div>
                </div>
            </div>

            <!-- Slide 2: Executive Summary & Key Questions -->
            <div class="slide" data-slide="2">
                <div class="slide-content">
                    <h1>Executive Summary & Key Questions</h1>
                    <div class="two-column">
                        <div class="column">
                            <h3>Core Concerns</h3>
                            <div class="concern-box">
                                <h4>Scoring Differential</h4>
                                <p>Selected companies: <strong>78.56% average</strong></p>
                                <p>Non-selected high performers: <strong>76.54% average (Mentari, Hornbill)</strong></p>
                                <p class="highlight">A strategic differential prioritizing accelerator fit.</p>
                            </div>
                            <div class="concern-box">
                                <h4>Geographic Selection</h4>
                                <p>Selected: <strong>71.43% Sarawakian</strong></p>
                                <p>Ensuring strong local impact and ecosystem development.</p>
                            </div>
                        </div>
                        <div class="column">
                            <h3>Strategic Response</h3>
                            <ul class="strategic-points">
                                <li>Focus on **development potential** and **accelerator fit** over raw scores.</li>
                                <li>Alignment with PCDS 2030 & SDE Blueprint 2030 priorities.</li>
                                <li>Optimized portfolio for maximum **transformative impact**.</li>
                                <li>Strategic geographic balance for ecosystem development.</li>
                                <li>Prioritizing companies that will benefit most from DiVA's intensive support.</li>
                            </ul>
                        </div>
                    </div>
                    <div class="ai-button-container">
                        <button class="btn btn--ai" onclick="generateQuestions('Executive Summary', 'Selected companies average score 78.56%, non-selected high performers average 76.54%. Selected 71.43% Sarawakian. Strategic response focuses on development potential, accelerator fit, PCDS/SDE alignment, portfolio optimization, and geographic balance.')">Generate Questions ‚ú®</button>
                    </div>
                    <div id="ai-response-2" class="ai-response-box"></div>
                </div>
            </div>

            <!-- Slide 3: Strategic Selection Framework -->
            <div class="slide" data-slide="3">
                <div class="slide-content">
                    <h2>Strategic Selection Framework</h2>
                    <div class="framework-grid">
                        <div class="framework-item">
                            <div class="framework-icon">üöÄ</div>
                            <h3>Development Potential</h3>
                            <p>Companies with significant room for growth and capacity to benefit from intensive acceleration.</p>
                        </div>
                        <div class="framework-item">
                            <div class="framework-icon">üéØ</div>
                            <h3>Strategic Alignment</h3>
                            <p>Direct alignment with Sarawak Digital Economy Blueprint 2030 and local ecosystem priorities.</p>
                        </div>
                        <div class="framework-item">
                            <div class="framework-icon">üí°</div>
                            <h3>Accelerator Fit</h3>
                            <p>Optimal stage for intensive mentorship, resource injection, and program support.</p>
                        </div>
                        <div class="framework-item">
                            <div class="framework-icon">üåê</div>
                            <h3>Potential Global Players</h3>
                            <p>Companies demonstrating ambition and capability to scale beyond local markets.</p>
                        </div>
                    </div>
                    <div class="ai-button-container">
                        <button class="btn btn--ai" onclick="generateQuestions('Strategic Selection Framework', 'Framework includes Development Potential, Strategic Alignment, Accelerator Fit, and Potential Global Players.')">Generate Questions ‚ú®</button>
                    </div>
                    <div id="ai-response-3" class="ai-response-box"></div>
                </div>
            </div>

            <!-- Slide 4: Scoring vs. Selection Analysis -->
            <div class="slide" data-slide="4">
                <div class="slide-content">
                    <h2>Scoring vs. Selection Analysis</h2>
                    <div class="analysis-section">
                        <div class="chart-container">
                            <canvas id="scoreComparisonChart"></canvas>
                        </div>
                        <div class="analysis-stats">
                            <div class="stat-item">
                                <span class="stat-number">78.56%</span>
                                <span class="stat-label">Average Score - Selected Cohort</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-number">76.54%</span>
                                <span class="stat-label">Average Score - Overqualified Not Selected</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-number">Strategic</span>
                                <span class="stat-label">Differential for Impact</span>
                            </div>
                        </div>
                    </div>
                    <div class="overqualification-content" style="text-align: center; margin-top: 30px;">
                        <h3>Why Some Higher-Scoring Companies Were Not Selected</h3>
                        <p>While companies like Mentari Alam EKO (77.08%) and Hornbill Agriculture (76.00%) achieved high scores, their advanced stage of development and established market presence suggest they might derive less **transformative benefit** from DiVA's accelerator program. Our focus is on maximizing the impact of our intensive support by selecting companies with significant **development potential** and a clear need for accelerator intervention to reach their next growth phase, rather than those already stable and mature.</p>
                    </div>
                </div>
            </div>

            <!-- Slide 5: Research-Backed Evidence -->
            <div class="slide" data-slide="5">
                <div class="slide-content">
                    <h2>Research-Backed Evidence</h2>
                    <div class="research-section">
                        <div class="research-principle">
                            <h3>Accelerator Best Practices</h3>
                            <blockquote>
                                "Successful accelerators focus on companies with high development potential rather than current performance. The optimal candidate shows strong fundamentals but clear areas for improvement through mentorship."
                            </blockquote>
                            <cite>‚Äî MIT Entrepreneurship Review, 2024</cite>
                        </div>
                        <div class="evidence-grid">
                            <div class="evidence-card">
                                <h4>Overqualification Risk</h4>
                                <p>Companies with established market positions may have limited improvement potential, reducing accelerator ROI and resource effectiveness.</p>
                            </div>
                            <div class="evidence-card">
                                <h4>Sweet Spot Range</h4>
                                <p>Companies with strong fundamentals but clear development needs represent the optimal balance for accelerator intervention.</p>
                            </div>
                            <div class="evidence-card">
                                <h4>Local Impact</h4>
                                <p>Regional accelerators show higher success rates when prioritizing local ecosystem development and companies that can be significantly shaped by the program.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slide 6: Geographic Distribution Analysis -->
            <div class="slide" data-slide="6">
                <div class="slide-content">
                    <h2>Geographic Distribution Analysis</h2>
                    <div class="geo-analysis">
                        <div class="chart-container">
                            <canvas id="geographicChart"></canvas>
                        </div>
                        <div class="geo-insights">
                            <h3>Strategic Impact</h3>
                            <div class="impact-metrics">
                                <div class="metric">
                                    <span class="metric-value">5/7</span>
                                    <span class="metric-label">Sarawakian Companies Selected</span>
                                </div>
                                <div class="metric">
                                    <span class="metric-value">71.43%</span>
                                    <span class="metric-label">Local Representation</span>
                                </div>
                                <div class="metric">
                                    <span class="metric-value">2/7</span>
                                    <span class="metric-label">Non-Sarawakian Companies Selected</span>
                                </div>
                            </div>
                            <p class="geo-rationale">
                                <strong>Rationale:</strong> Prioritizing Sarawakian companies aligns with program objectives to develop the local digital economy ecosystem while maintaining high quality and diversity standards. The inclusion of non-Sarawakian companies strategically brings external expertise and broader market perspectives crucial for the cohort's overall growth.
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slide 7: Maxeon Technologies -->
            <div class="slide" data-slide="7">
                <div class="slide-content startup-slide">
                    <div class="startup-header">
                        <h1>MAXEON TECHNOLOGIES</h1>
                        <div class="startup-meta">
                            <span class="score">Score: 85.63%</span>
                            <span class="status sarawakian">Sarawakian Startup</span>
                        </div>
                    </div>
                    <div class="startup-details">
                        <div class="description-box">
                            <h3>Technology & Innovation</h3>
                            <p>Forest monitoring technology with AI-powered analysis, achieving up to 97% accuracy at a fraction of LiDAR costs.</p>
                        </div>
                        <div class="alignment-section">
                            <div class="alignment-item">
                                <h4>Strategic Alignment</h4>
                                <p>Critical for Sarawak's 70% forest coverage management and Forest Department technology initiatives.</p>
                            </div>
                            <div class="alignment-item">
                                <h4>PCDS 2030 Alignment</h4>
                                <p>Environmental sustainability pillar, digital transformation enabler.</p>
                            </div>
                            <div class="alignment-item">
                                <h4>SDE Blueprint 2030</h4>
                                <p>Economic Growth Priorities pillar - digitalizing forestry sector.</p>
                            </div>
                        </div>
                    </div>
                    <div class="ai-button-container">
                        <button class="btn btn--ai" onclick="elaborateStartup('Maxeon Technologies', 'Forest monitoring technology with AI-powered analysis, achieving up to 97% accuracy at a fraction of LiDAR costs. Critical for Sarawak\'s 70% forest coverage management and Forest Department technology initiatives. Aligns with PCDS 2030 Environmental sustainability pillar and SDE Blueprint 2030 for digitalizing forestry sector.')">Elaborate ‚ú®</button>
                    </div>
                </div>
            </div>

            <!-- Slide 8: ROBOPRENEUR -->
            <div class="slide" data-slide="8">
                <div class="slide-content startup-slide">
                    <div class="startup-header">
                        <h1>ROBOPRENEUR</h1>
                        <div class="startup-meta">
                            <span class="score">Score: 82.81%</span>
                            <span class="status non-sarawakian">Non-Sarawakian (Sarawak Presence)</span>
                        </div>
                    </div>
                    <div class="startup-details">
                        <div class="description-box">
                            <h3>Technology & Innovation</h3>
                            <p>AI service robotics for professional and domestic use. Current deployment includes robots with Sarawak Energy Berhad, training local personnel.</p>
                            <p><strong>Key Achievement:</strong> Created Malaysia's first humanoid robot ADAM.</p>
                        </div>
                        <div class="alignment-section">
                            <div class="alignment-item">
                                <h4>Strategic Alignment</h4>
                                <p>Existing operations training local Sarawakian personnel, supports automation initiatives, potential landing pad for autonomous robot manufacturing in Sarawak.</p>
                            </div>
                            <div class="alignment-item">
                                <h4>PCDS 2030 Alignment</h4>
                                <p>Innovation enabler, manufacturing modernization.</p>
                            </div>
                            <div class="alignment-item">
                                <h4>SDE Blueprint 2030</h4>
                                <p>Frontier Technologies Adoption pillar.</p>
                            </div>
                        </div>
                    </div>
                    <div class="ai-button-container">
                        <button class="btn btn--ai" onclick="elaborateStartup('ROBOPRENEUR', 'AI service robotics for professional and domestic use. Deployed with Sarawak Energy Berhad, training local personnel. Created Malaysia\'s first humanoid robot ADAM. Strategic alignment includes supporting automation initiatives and potential for autonomous robot manufacturing in Sarawak. Aligns with PCDS 2030 innovation and SDE Blueprint 2030 Frontier Technologies Adoption.')">Elaborate ‚ú®</button>
                    </div>
                </div>
            </div>

            <!-- Slide 9: OINC Sdn. Bhd. -->
            <div class="slide" data-slide="9">
                <div class="slide-content startup-slide">
                    <div class="startup-header">
                        <h1>OINC Sdn. Bhd.</h1>
                        <div class="startup-meta">
                            <span class="score">Score: 80.63%</span>
                            <span class="status sarawakian">Sarawakian Startup</span>
                        </div>
                    </div>
                    <div class="startup-details">
                        <div class="description-box">
                            <h3>Technology & Innovation</h3>
                            <p>Smart mushroom farming using sawdust substrate from timber companies. IoT-equipped containers increase yield by 20%.</p>
                        </div>
                        <div class="alignment-section">
                            <div class="alignment-item">
                                <h4>Strategic Alignment</h4>
                                <p>Addresses Malaysia's 60% food import dependency, utilizes Sarawak's abundant timber waste, agriculture sector transformation.</p>
                            </div>
                            <div class="alignment-item">
                                <h4>PCDS 2030 Alignment</h4>
                                <p>Agriculture sector transformation, circular economy.</p>
                            </div>
                            <div class="alignment-item">
                                <h4>SDE Blueprint 2030</h4>
                                <p>Economic Growth Priorities - agriculture digitalization.</p>
                            </div>
                        </div>
                    </div>
                    <div class="ai-button-container">
                        <button class="btn btn--ai" onclick="elaborateStartup('OINC Sdn. Bhd.', 'Smart mushroom farming using sawdust substrate from timber companies. IoT-equipped containers increase yield by 20%. Addresses Malaysia\'s 60% food import dependency and utilizes Sarawak\'s abundant timber waste. Aligns with PCDS 2030 agriculture sector transformation and SDE Blueprint 2030 agriculture digitalization.')">Elaborate ‚ú®</button>
                    </div>
                </div>
            </div>

            <!-- Slide 10: Sustainaviro Technology -->
            <div class="slide" data-slide="10">
                <div class="slide-content startup-slide">
                    <div class="startup-header">
                        <h1>SUSTAINAVIRO TECHNOLOGY</h1>
                        <div class="startup-meta">
                            <span class="score">Score: 75.50%</span>
                            <span class="status sarawakian">Sarawakian Startup</span>
                        </div>
                    </div>
                    <div class="startup-details">
                        <div class="description-box">
                            <h3>Technology & Innovation</h3>
                            <p>Plastic waste to biofuel conversion technology with 100% conversion efficiency in 45 minutes.</p>
                            <p><strong>Proven Results:</strong> Successfully demonstrated in Cyberjaya.</p>
                        </div>
                        <div class="alignment-section">
                            <div class="alignment-item">
                                <h4>Strategic Alignment</h4>
                                <p>Supports Sarawak's Zero Waste Agenda and circular economy initiatives, renewable energy enabler.</p>
                            </div>
                            <div class="alignment-item">
                                <h4>PCDS 2030 Alignment</h4>
                                <p>Environmental sustainability, renewable energy enabler.</p>
                            </div>
                            <div class="alignment-item">
                                <h4>SDE Blueprint 2030</h4>
                                <p>Economic Growth Priorities - environmental technology.</p>
                            </div>
                        </div>
                    </div>
                    <div class="ai-button-container">
                        <button class="btn btn--ai" onclick="elaborateStartup('Sustainaviro Technology', 'Plastic waste to biofuel conversion technology with 100% conversion efficiency in 45 minutes, successfully demonstrated in Cyberjaya. Supports Sarawak\'s Zero Waste Agenda and circular economy initiatives, and acts as a renewable energy enabler. Aligns with PCDS 2030 environmental sustainability and SDE Blueprint 2030 environmental technology.')">Elaborate ‚ú®</button>
                    </div>
                </div>
            </div>

            <!-- Slide 11: Stinablis Sdn Bhd -->
            <div class="slide" data-slide="11">
                <div class="slide-content startup-slide">
                    <div class="startup-header">
                        <h1>STINABLIS Sdn Bhd</h1>
                        <div class="startup-meta">
                            <span class="score">Score: 75.36%</span>
                            <span class="status sarawakian">Sarawakian Startup</span>
                        </div>
                    </div>
                    <div class="startup-details">
                        <div class="description-box">
                            <h3>Technology & Innovation</h3>
                            <p>Sustainable composite materials using pineapple fibers and bio-waste.</p>
                            <p><strong>Unique Position:</strong> Only Sarawakian company in sustainable manufacturing materials, completed initial POCs, secured seed funding.</p>
                        </div>
                        <div class="alignment-section">
                            <div class="alignment-item">
                                <h4>Strategic Alignment</h4>
                                <p>Supports manufacturing sector sustainability, circular economy.</p>
                            </div>
                            <div class="alignment-item">
                                <h4>PCDS 2030 Alignment</h4>
                                <p>Manufacturing sector transformation, environmental sustainability.</p>
                            </div>
                            <div class="alignment-item">
                                <h4>SDE Blueprint 2030</h4>
                                <p>Economic Growth Priorities - sustainable manufacturing.</p>
                            </div>
                        </div>
                    </div>
                    <div class="ai-button-container">
                        <button class="btn btn--ai" onclick="elaborateStartup('Stinablis Sdn Bhd', 'Sustainable composite materials using pineapple fibers and bio-waste. Unique as the only Sarawakian company in sustainable manufacturing materials, with initial POCs completed and seed funding secured. Supports manufacturing sector sustainability and circular economy. Aligns with PCDS 2030 manufacturing transformation and SDE Blueprint 2030 sustainable manufacturing.')">Elaborate ‚ú®</button>
                    </div>
                </div>
            </div>

            <!-- Slide 12: CtrlD Studio -->
            <div class="slide" data-slide="12">
                <div class="slide-content startup-slide">
                    <div class="startup-header">
                        <h1>CTRL-D STUDIO</h1>
                        <div class="startup-meta">
                            <span class="score">Score: 75.00%</span>
                            <span class="status sarawakian">Sarawakian Startup</span>
                        </div>
                    </div>
                    <div class="startup-details">
                        <div class="description-box">
                            <h3>Technology & Innovation</h3>
                            <p>Game development studio producing Malaysian-made video game IP.</p>
                            <p><strong>Community Impact:</strong> Building Sarawak Game Developer Community.</p>
                            <p><strong>Recognition:</strong> Featured by Microsoft Xbox Developer Acceleration Program and IGN.</p>
                        </div>
                        <div class="alignment-section">
                            <div class="alignment-item">
                                <h4>Strategic Alignment</h4>
                                <p>Creative tech industry development, talent ecosystem building.</p>
                            </div>
                            <div class="alignment-item">
                                <h4>PCDS 2030 Alignment</h4>
                                <p>Social services sector, human capital development.</p>
                            </div>
                            <div class="alignment-item">
                                <h4>SDE Blueprint 2030</h4>
                                <p>Digital Business Development - creative industries.</p>
                            </div>
                        </div>
                        <div class="special-note">
                            <p><strong>Note:</strong> Receives mentorship only, not RM150,000 grant, optimizing resource allocation.</p>
                        </div>
                    </div>
                    <div class="ai-button-container">
                        <button class="btn btn--ai" onclick="elaborateStartup('CTRL-D Studio', 'Game development studio producing Malaysian-made video game IP. Actively building Sarawak Game Developer Community and recognized by Microsoft Xbox Developer Acceleration Program and IGN. Strategic alignment includes creative tech industry development and talent ecosystem building. Aligns with PCDS 2030 social services and SDE Blueprint 2030 creative industries.')">Elaborate ‚ú®</button>
                    </div>
                </div>
            </div>

            <!-- Slide 13: SpaceIn Sdn Bhd -->
            <div class="slide" data-slide="13">
                <div class="slide-content startup-slide">
                    <div class="startup-header">
                        <h1>SPACEIN Sdn Bhd</h1>
                        <div class="startup-meta">
                            <span class="score">Score: 75.00%</span>
                            <span class="status non-sarawakian">Non-Sarawakian (USM Spin-off)</span>
                        </div>
                    </div>
                    <div class="startup-details">
                        <div class="description-box">
                            <h3>Technology & Innovation</h3>
                            <p>Microsatellite development and IoT connectivity for remote areas.</p>
                            <p><strong>Recent Achievement:</strong> Launched Malaysia's first picosatellite SpaceANT-D.</p>
                        </div>
                        <div class="alignment-section">
                            <div class="alignment-item">
                                <h4>Strategic Alignment</h4>
                                <p>Supports Sarawak's aerospace industry development, aligns with planned Aerospace Industrial Park, engagement with iCATS for aerospace talent development.</p>
                            </div>
                            <div class="alignment-item">
                                <h4>PCDS 2030 Alignment</h4>
                                <p>Innovation enabler, digital transformation.</p>
                            </div>
                            <div class="alignment-item">
                                <h4>SDE Blueprint 2030</h4>
                                <p>Frontier Technologies Adoption, aerospace sector development.</p>
                            </div>
                        </div>
                    </div>
                    <div class="ai-button-container">
                        <button class="btn btn--ai" onclick="elaborateStartup('SpaceIn Sdn Bhd', 'Microsatellite development and IoT connectivity for remote areas, launched Malaysia\'s first picosatellite SpaceANT-D. Supports Sarawak\'s aerospace industry development, aligns with planned Aerospace Industrial Park, and engages with iCATS for aerospace talent development. Aligns with PCDS 2030 innovation and SDE Blueprint 2030 Frontier Technologies Adoption and aerospace sector development.')">Elaborate ‚ú®</button>
                    </div>
                </div>
            </div>

            <!-- Slide 14: Addressing Overqualification Concerns -->
            <div class="slide" data-slide="14">
                <div class="slide-content">
                    <h2>Addressing Overqualification Concerns</h2>
                    <div class="concerns-section">
                        <h3>Why Higher-Scoring Companies Were Not Selected</h3>
                        <div class="companies-comparison">
                            <div class="not-selected-list">
                                <h4>Companies Deemed Overqualified / Stable</h4>
                                <div class="company-item">
                                    <span class="company-name">Mentari Alam EKO (M) Sdn Bhd (77.08%)</span>
                                    <span class="company-reason">- Mature IoT platform, established digital infrastructure, award-winning technology.</span>
                                </div>
                                <div class="company-item">
                                    <span class="company-name">Hornbill Agriculture Sdn Bhd (76.00%)</span>
                                    <span class="company-reason">- Consistent EBITDA growth, established strategic partnerships, proven market position.</span>
                                </div>
                                <div class="company-item">
                                    <span class="company-name">Shieldbase Sdn Bhd (65.63%)</span>
                                    <span class="company-reason">- 25+ enterprise clients, proven scalability.</span>
                                </div>
                            </div>
                            <div class="rationale-box">
                                <h4>Selection Rationale: Maximizing DiVA's Impact</h4>
                                <p>While the above companies demonstrate significant market success and maturity, they are considered to be beyond the typical intervention scope of DiVA. Our accelerator program is designed to provide intensive support and resources to companies with high **development potential** and a clear need for acceleration to overcome specific growth barriers. Allocating resources to already stable and mature entities would limit the transformative impact DiVA can achieve. The selected cohort, while some having slightly lower overall scores, offers a better fit for the program's objectives of fostering significant growth and contributing directly to Sarawak's digital transformation journey.</p>
                            </div>
                        </div>
                    </div>
                    <div class="ai-button-container">
                        <button class="btn btn--ai" onclick="suggestCounterArguments('Addressing Overqualification Concerns', 'Mentari Alam EKO (77.08%) - mature IoT platform. Hornbill Agriculture (76.00%) - consistent EBITDA growth. Shieldbase (65.63%) - 25+ enterprise clients. Rationale: These companies are too mature for accelerator intervention; DiVA focuses on high development potential and transformative impact. Resources are better allocated to companies that need and will benefit most from acceleration.')">Suggest Counter-Arguments ‚ú®</button>
                    </div>
                    <div id="ai-response-14" class="ai-response-box"></div>
                </div>
            </div>

            <!-- Slide 15: Conclusion & Recommendations -->
            <div class="slide" data-slide="15">
                <div class="slide-content">
                    <h2>Conclusion & Recommendations</h2>
                    <div class="conclusion-section">
                        <div class="key-conclusions">
                            <h3>Key Conclusions</h3>
                            <div class="conclusion-point">
                                <span class="point-number">1</span>
                                <div class="point-content">
                                    <h4>Strategic Selection Justified by Accelerator Fit</h4>
                                    <p>The chosen cohort, while not exclusively the absolute highest scorers, represents the optimal selection for DiVA. These companies possess the highest **development potential** and are at a stage where intensive accelerator intervention can yield the most significant **transformative impact**, maximizing program ROI.</p>
                                </div>
                            </div>
                            <div class="conclusion-point">
                                <span class="point-number">2</span>
                                <div class="point-content">
                                    <h4>Ecosystem Focus & Global Ambition Achieved</h4>
                                    <p>With a strong Sarawakian representation (71.43%) and the inclusion of non-Sarawakian companies bringing external expertise, the selection effectively supports local digital economy development objectives while fostering a cohort with global scalability.</p>
                                </div>
                            </div>
                            <div class="conclusion-point">
                                <span class="point-number">3</span>
                                <div class="point-content">
                                    <h4>Portfolio Optimized for Transformative Growth</h4>
                                    <p>The selected 7 startups offer a robust and balanced portfolio, strategically chosen for their capacity to be profoundly shaped and accelerated by DiVA, ensuring a high likelihood of significant success and direct contribution to Sarawak's digital transformation journey.</p>
                                </div>
                            </div>
                        </div>
                        <div class="recommendations">
                            <h3>Recommendations</h3>
                            <ul class="recommendations-list">
                                <li><strong>Proceed with the selected cohort</strong> as it represents the strategically optimal choice for maximizing DiVA's accelerator impact and achieving its core objectives.</li>
                                <li>Monitor development progress closely to showcase the transformative success of this cohort.</li>
                                <li>Explore alternative support mechanisms or partnerships for other promising, but more mature, companies not in this cohort.</li>
                                <li>Document outcomes meticulously to refine future selection methodologies based on this impact-driven approach.</li>
                            </ul>
                        </div>
                    </div>
                    <div class="ai-button-container">
                        <button class="btn btn--ai" onclick="generateQuestions('Conclusion & Recommendations', 'Strategic selection justified by accelerator fit and development potential. Ecosystem focus achieved with 71.43% Sarawakian representation and global ambition. Portfolio optimized for transformative growth.')">Generate Questions ‚ú®</button>
                    </div>
                    <div id="ai-response-15" class="ai-response-box"></div>
                </div>
            </div>
        </div>

        <!-- Slide Navigator -->
        <div class="slide-navigator">
            <div class="slide-dots">
                <!-- Dots will be dynamically generated by JavaScript -->
            </div>
        </div>
    </div>

    <!-- Modal for AI Elaborations -->
    <div id="aiModal" class="modal-overlay">
        <div class="modal-content">
            <button class="modal-close-btn" onclick="closeModal()">‚úñ</button>
            <h3 id="modalTitle"></h3>
            <div class="loading-spinner" id="modalSpinner"></div>
            <p id="modalText"></p>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const slides = document.querySelectorAll('.slide');
            const totalSlides = slides.length;
            let currentSlideIndex = 0;

            const currentSlideSpan = document.getElementById('current-slide');
            const totalSlidesSpan = document.getElementById('total-slides');
            const prevBtn = document.getElementById('prev-btn');
            const nextBtn = document.getElementById('next-btn');
            const slideDotsContainer = document.querySelector('.slide-dots');
            const aiModal = document.getElementById('aiModal');
            const modalTitle = document.getElementById('modalTitle');
            const modalText = document.getElementById('modalText');
            const modalSpinner = document.getElementById('modalSpinner');

            // Initialize total slides display
            if (totalSlidesSpan) {
                totalSlidesSpan.textContent = totalSlides;
            }

            // Create slide dots dynamically
            for (let i = 0; i < totalSlides; i++) {
                const dot = document.createElement('button');
                dot.classList.add('dot');
                dot.dataset.slide = i + 1; // 1-based indexing for data-slide
                dot.addEventListener('click', () => goToSlide(i));
                slideDotsContainer.appendChild(dot);
            }

            const dots = document.querySelectorAll('.dot');

            const updateSlideDisplay = () => {
                slides.forEach((slide, index) => {
                    if (index === currentSlideIndex) {
                        slide.classList.add('active');
                    } else {
                        slide.classList.remove('active');
                    }
                });

                dots.forEach((dot, index) => {
                    if (index === currentSlideIndex) {
                        dot.classList.add('active');
                    } else {
                        dot.classList.remove('active');
                    }
                });

                if (currentSlideSpan) {
                    currentSlideSpan.textContent = currentSlideIndex + 1;
                }

                prevBtn.disabled = currentSlideIndex === 0;
                nextBtn.disabled = currentSlideIndex === totalSlides - 1;

                // Hide all AI response boxes when changing slides
                document.querySelectorAll('.ai-response-box').forEach(box => {
                    box.classList.remove('active');
                    box.innerHTML = ''; // Clear content
                });
            };

            const goToSlide = (index) => {
                if (index >= 0 && index < totalSlides) {
                    currentSlideIndex = index;
                    updateSlideDisplay();
                }
            };

            prevBtn.addEventListener('click', () => {
                goToSlide(currentSlideIndex - 1);
            });

            nextBtn.addEventListener('click', () => {
                goToSlide(currentSlideIndex + 1);
            });

            // Initial display update
            updateSlideDisplay();

            // Chart.js Initialization (placeholders)
            const initializeCharts = () => {
                // Score Comparison Chart
                const scoreCtx = document.getElementById('scoreComparisonChart');
                if (scoreCtx) {
                    new Chart(scoreCtx, {
                        type: 'bar',
                        data: {
                            labels: ['Selected Cohort (Avg.)', 'Overqualified (Avg.)'],
                            datasets: [{
                                label: 'Average Score',
                                data: [78.56, 76.54], /* Avg of user's selected 7 vs. Avg of Mentari and Hornbill */
                                backgroundColor: [
                                    'rgba(42, 111, 139, 0.7)', /* Primary blue */
                                    'rgba(255, 99, 132, 0.7)' /* Red for comparison */
                                ],
                                borderColor: [
                                    'rgba(42, 111, 139, 1)',
                                    'rgba(255, 99, 132, 1)'
                                ],
                                borderWidth: 1
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    max: 100, /* Max score is 100% */
                                    title: {
                                        display: true,
                                        text: 'Score (%)'
                                    }
                                }
                            },
                            plugins: {
                                title: {
                                    display: true,
                                    text: 'Average Score Comparison: Selected vs. Overqualified'
                                }
                            }
                        }
                    });
                }

                // Geographic Distribution Chart (Doughnut)
                const geoCtx = document.getElementById('geographicChart');
                if (geoCtx) {
                    new Chart(geoCtx, {
                        type: 'doughnut',
                        data: {
                            labels: ['Sarawakian Companies', 'Non-Sarawakian Companies'],
                            datasets: [{
                                label: 'Selected Companies',
                                data: [5, 2], /* 5 Sarawakian (Maxeon, OINC, Sustainaviro, Stinablis, CtrlD), 2 Non-Sarawakian (ROBOPRENEUR, SpaceIn) */
                                backgroundColor: [
                                    'rgba(75, 192, 192, 0.7)', /* Greenish-blue for Sarawak */
                                    'rgba(153, 102, 255, 0.7)' /* Purple for Non-Sarawak */
                                ],
                                borderColor: [
                                    'rgba(75, 192, 192, 1)',
                                    'rgba(153, 102, 255, 1)'
                                ],
                                borderWidth: 1
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                title: {
                                    display: true,
                                    text: 'Geographic Distribution of Selected Companies'
                                }
                            }
                        }
                    });
                }
            };

            // Call initializeCharts when the DOM is ready
            initializeCharts();

            // --- Gemini API Integration Functions ---

            // Function to open the modal
            window.openModal = (title, content) => {
                modalTitle.textContent = title;
                modalText.innerHTML = content;
                aiModal.classList.add('active');
            };

            // Function to close the modal
            window.closeModal = () => {
                aiModal.classList.remove('active');
                modalText.innerHTML = '';
                modalTitle.textContent = '';
            };

            // Function to show/hide loading spinner in modal
            const showModalSpinner = () => {
                modalSpinner.classList.add('active');
                modalText.style.display = 'none';
            };

            const hideModalSpinner = () => {
                modalSpinner.classList.remove('active');
                modalText.style.display = 'block';
            };

            // Function to elaborate on startup details
            window.elaborateStartup = async (startupName, details) => {
                openModal(`Elaborating on ${startupName}...`, '<p>Loading detailed insights...</p>');
                showModalSpinner();

                const prompt = `Elaborate on the following details for the startup "${startupName}":\n\n${details}\n\nProvide a comprehensive explanation focusing on their technology, innovation, and strategic relevance in a concise paragraph.`;
                
                try {
                    let chatHistory = [];
                    chatHistory.push({ role: "user", parts: [{ text: prompt }] });
                    const payload = { contents: chatHistory };
                    const apiKey = ""; // Canvas will provide this at runtime
                    const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    const result = await response.json();
                    if (result.candidates && result.candidates.length > 0 &&
                        result.candidates[0].content && result.candidates[0].content.parts &&
                        result.candidates[0].content.parts.length > 0) {
                        const text = result.candidates[0].content.parts[0].text;
                        modalText.innerHTML = `<p>${text}</p>`;
                    } else {
                        modalText.innerHTML = '<p>Could not generate elaboration. Please try again.</p>';
                    }
                } catch (error) {
                    console.error('Error calling Gemini API:', error);
                    modalText.innerHTML = '<p>An error occurred while fetching elaboration. Please check your network connection or try again later.</p>';
                } finally {
                    hideModalSpinner();
                }
            };

            // Function to generate questions for a slide
            window.generateQuestions = async (slideTitle, slideContent) => {
                const responseBoxId = `ai-response-${currentSlideIndex + 1}`;
                const responseBox = document.getElementById(responseBoxId);
                
                // Clear previous content and show loading spinner
                responseBox.innerHTML = `<h4>Potential Questions for ${slideTitle}</h4><div class="loading-spinner active"></div><p>Generating questions...</p>`;
                responseBox.classList.add('active');

                const prompt = `Based on the following content from the slide "${slideTitle}", generate 3 concise, thought-provoking questions that Professor Jugdutt might ask during the presentation. Format them as a numbered list.\n\nContent: ${slideContent}`;
                
                try {
                    let chatHistory = [];
                    chatHistory.push({ role: "user", parts: [{ text: prompt }] });
                    const payload = { contents: chatHistory };
                    const apiKey = ""; // Canvas will provide this at runtime
                    const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    const result = await response.json();
                    if (result.candidates && result.candidates.length > 0 &&
                        result.candidates[0].content && result.candidates[0].content.parts &&
                        result.candidates[0].content.parts.length > 0) {
                        const text = result.candidates[0].content.parts[0].text;
                        responseBox.innerHTML = `<h4>Potential Questions for ${slideTitle}</h4>${text}`;
                    } else {
                        responseBox.innerHTML = `<h4>Potential Questions for ${slideTitle}</h4><p>Could not generate questions. Please try again.</p>`;
                    }
                } catch (error) {
                    console.error('Error calling Gemini API:', error);
                    responseBox.innerHTML = `<h4>Potential Questions for ${slideTitle}</h4><p>An error occurred while fetching questions. Please check your network connection or try again later.</p>`;
                } finally {
                    // Hide spinner after response
                    responseBox.querySelector('.loading-spinner')?.classList.remove('active');
                }
            };

            // Function to suggest counter-arguments
            window.suggestCounterArguments = async (slideTitle, slideContent) => {
                const responseBoxId = `ai-response-${currentSlideIndex + 1}`;
                const responseBox = document.getElementById(responseBoxId);
                
                // Clear previous content and show loading spinner
                responseBox.innerHTML = `<h4>Counter-Arguments & Rebuttals for ${slideTitle}</h4><div class="loading-spinner active"></div><p>Generating suggestions...</p>`;
                responseBox.classList.add('active');

                const prompt = `Given the following content from the slide "${slideTitle}", identify 2-3 potential counter-arguments or critical questions Professor Jugdutt might raise, and for each, provide a brief, effective rebuttal or clarifying point. Focus on arguments against selecting the current cohort or questions about the exclusion of higher-scoring companies. Format as a list where each item is "Counter-argument: [argument] - Rebuttal: [rebuttal]".\n\nContent: ${slideContent}`;
                
                try {
                    let chatHistory = [];
                    chatHistory.push({ role: "user", parts: [{ text: prompt }] });
                    const payload = { contents: chatHistory };
                    const apiKey = ""; // Canvas will provide this at runtime
                    const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    const result = await response.json();
                    if (result.candidates && result.candidates.length > 0 &&
                        result.candidates[0].content && result.candidates[0].content.parts &&
                        result.candidates[0].content.parts.length > 0) {
                        const text = result.candidates[0].content.parts[0].text;
                        responseBox.innerHTML = `<h4>Counter-Arguments & Rebuttals for ${slideTitle}</h4>${text}`;
                    } else {
                        responseBox.innerHTML = `<h4>Counter-Arguments & Rebuttals for ${slideTitle}</h4><p>Could not generate suggestions. Please try again.</p>`;
                    }
                } catch (error) {
                    console.error('Error calling Gemini API:', error);
                    responseBox.innerHTML = `<h4>Counter-Arguments & Rebuttals for ${slideTitle}</h4><p>An error occurred while fetching suggestions. Please check your network connection or try again later.</p>`;
                } finally {
                    // Hide spinner after response
                    responseBox.querySelector('.loading-spinner')?.classList.remove('active');
                }
            };
        });
    </script>
</body>
</html>
